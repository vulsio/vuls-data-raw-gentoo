{
	"ID": "200407-02",
	"Title": "Linux Kernel: Multiple vulnerabilities",
	"Synopsis": "\n    Multiple vulnerabilities have been found in the Linux kernel used by\n    GNU/Linux systems. Patched, or updated versions of these kernels have been\n    released and details are included in this advisory.\n  ",
	"Product": {
		"Text": "Kernel",
		"Type": "ebuild"
	},
	"Announced": "2004-07-03",
	"Revised": {
		"Text": "2011-03-27",
		"Count": "04"
	},
	"Bug": [
		"47881",
		"49637",
		"53804",
		"54976",
		"55698"
	],
	"Access": "local",
	"Affected": {
		"Package": [
			{
				"Name": "sys-kernel/aa-sources",
				"Auto": "no",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.23-r2",
						"Range": "eq",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.23-r2",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/alpha-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.21-r8",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.21-r8",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/ck-sources",
				"Auto": "no",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.26-r1",
						"Range": "eq",
						"Slot": ""
					},
					{
						"Text": "2.6.7-r1",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.6.7-r1",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/compaq-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.9.32.7-r7",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.9.32.7-r7",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/development-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.6.7",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.6.7",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/gaming-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.20-r14",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.20-r14",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/gentoo-dev-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.6.7",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.6.7",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/gentoo-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.19-r17",
						"Range": "rge",
						"Slot": ""
					},
					{
						"Text": "2.4.20-r20",
						"Range": "rge",
						"Slot": ""
					},
					{
						"Text": "2.4.22-r12",
						"Range": "rge",
						"Slot": ""
					},
					{
						"Text": "2.4.25-r5",
						"Range": "rge",
						"Slot": ""
					},
					{
						"Text": "2.4.26-r3",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.26-r3",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/grsec-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.26.2.0-r5",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.26.2.0-r5",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/gs-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.25_pre7-r7",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.25_pre7-r7",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/hardened-dev-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.6.7",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.6.7",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/hardened-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.26-r2",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.26-r2",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/hppa-dev-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.6.7",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.6.7",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/hppa-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.26_p6",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.26_p6",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/ia64-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.24-r5",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.24-r5",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/mips-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.26-r3",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.26-r3",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/mm-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.6.7-r1",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.6.7-r1",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/openmosix-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.22-r10",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.22-r10",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/pac-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.23-r8",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.23-r8",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/pegasos-dev-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.6.7",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.6.7",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/pegasos-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.26-r2",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.26-r2",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/planet-ccrma-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.21-r10",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.21-r10",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/ppc-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.26-r2",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.26-r2",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/ppc64-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.6.7",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.6.7",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/rsbac-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.26-r2",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.26-r2",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/rsbac-dev-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.6.7-r1",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.6.7-r1",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/selinux-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.26-r2",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.26-r2",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/sparc-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.26-r2",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.26-r2",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/uclinux-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.26_p0-r2",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.26_p0-r2",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/usermode-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.24-r5",
						"Range": "rge",
						"Slot": ""
					},
					{
						"Text": "2.4.26-r2",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.26-r2",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/vserver-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.0",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.0",
						"Range": "lt",
						"Slot": ""
					},
					{
						"Text": "2.4",
						"Range": "ge",
						"Slot": ""
					},
					{
						"Text": "2.4.26.1.3.9-r2",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/win4lin-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.26-r2",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.26-r2",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/wolk-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "4.9-r9",
						"Range": "rge",
						"Slot": ""
					},
					{
						"Text": "4.11-r6",
						"Range": "rge",
						"Slot": ""
					},
					{
						"Text": "4.14-r3",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "4.14-r3",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/xbox-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.6.7",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.6.7",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/xfs-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.24-r8",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.24-r8",
						"Range": "lt",
						"Slot": ""
					}
				]
			},
			{
				"Name": "sys-kernel/vanilla-sources",
				"Auto": "yes",
				"Arch": "*",
				"Unaffected": [
					{
						"Text": "2.4.27",
						"Range": "ge",
						"Slot": ""
					}
				],
				"Vulnerable": [
					{
						"Text": "2.4.26",
						"Range": "le",
						"Slot": ""
					}
				]
			}
		],
		"Service": {
			"Text": "",
			"Type": "",
			"Fixed": ""
		}
	},
	"Background": {
		"Text": "\n    <p>\n    The Linux kernel is responsible for managing the core aspects of a\n    GNU/Linux system, providing an interface for core system applications\n    as well as providing the essential structure and capability to access\n    hardware that is needed for a running system.\n    </p>\n  "
	},
	"Description": {
		"Text": "\n    <p>\n    Multiple flaws have been discovered in the Linux kernel. This advisory\n    corrects the following issues:\n    </p>\n    <ul>\n    <li>\n    CAN-2004-0109: This vulnerability allows privilege escalation using\n    ISO9660 file systems through a buffer overflow via a malformed file\n    system containing a long symbolic link entry. This can allow arbitrary\n    code execution at kernel level.\n    </li>\n    <li>\n    CAN-2004-0133: The XFS file system in 2.4 series kernels has an\n    information leak by which data in the memory can be written to the\n    device hosting the file system, allowing users to obtain portions of\n    kernel memory by reading the raw block device.\n    </li>\n    <li>\n    CAN-2004-0177: The ext3 file system in 2.4 series kernels does not\n    properly initialize journal descriptor blocks, causing an information\n    leak by which data in the memory can be written to the device hosting\n    the file system, allowing users to obtain portions of kernel memory by\n    reading the raw device.\n    </li>\n    <li>\n    CAN-2004-0181: The JFS file system in 2.4 series kernels has an\n    information leak by which data in the memory can be written to the\n    device hosting the file system, allowing users to obtain portions of\n    kernel memory by reading the raw device.\n    </li>\n    <li>\n    CAN-2004-0178: The OSS Sound Blaster [R] Driver has a Denial of Service\n    vulnerability since it does not handle certain sample sizes properly.\n    This allows local users to hang the kernel.\n    </li>\n    <li>\n    CAN-2004-0228: Due to an integer signedness error in the CPUFreq /proc\n    handler code in 2.6 series Linux kernels, local users can escalate\n    their privileges.\n    </li>\n    <li>\n    CAN-2004-0229: The framebuffer driver in 2.6 series kernel drivers does\n    not use the fb_copy_cmap method of copying structures. The impact of\n    this issue is unknown, however.\n    </li>\n    <li>\n    CAN-2004-0394: A buffer overflow in the panic() function of 2.4 series\n    Linux kernels exists, but it may not be exploitable under normal\n    circumstances due to its functionality.\n    </li>\n    <li>\n    CAN-2004-0427: The do_fork() function in both 2.4 and 2.6 series Linux\n    kernels does not properly decrement the mm_count counter when an error\n    occurs, triggering a memory leak that allows local users to cause a\n    Denial of Service by exhausting other applications of memory; causing\n    the kernel to panic or to kill services.\n    </li>\n    <li>\n    CAN-2004-0495: Multiple vulnerabilities found by the Sparse source\n    checker in the kernel allow local users to escalate their privileges or\n    gain access to kernel memory.\n    </li>\n    <li>\n    CAN-2004-0535: The e1000 NIC driver does not properly initialize memory\n    structures before using them, allowing users to read kernel memory.\n    </li>\n    <li>\n    CAN-2004-0554: 2.4 and 2.6 series kernels running on an x86 or an AMD64\n    architecture allow local users to cause a Denial of Service by a total\n    system hang, due to an infinite loop that triggers a signal handler\n    with a certain sequence of fsave and frstor instructions.\n    </li>\n    <li>\n    Local DoS in PaX: If ASLR is enabled as a GRSecurity PaX feature, a\n    Denial of Service can be achieved by putting the kernel into an\n    infinite loop. Only 2.6 series GRSecurity kernels are affected by this\n    issue.\n    </li>\n    <li>\n    RSBAC 1.2.3 JAIL issues: A flaw in the RSBAC JAIL implementation allows\n    suid/sgid files to be created inside the jail since the relevant module\n    does not check the corresponding mode values. This can allow privilege\n    escalation inside the jail. Only rsbac-(dev-)sources are affected by\n    this issue.\n    </li>\n    </ul>\n  "
	},
	"Impact": {
		"Type": "high",
		"Text": "\n    <p>\n    Arbitrary code with normal non-super-user privileges may be able to\n    exploit any of these vulnerabilities; gaining kernel level access to\n    memory structures and hardware devices. This may be used for further\n    exploitation of the system, to leak sensitive data or to cause a Denial\n    of Service on the affected kernel.\n    </p>\n  "
	},
	"Workaround": {
		"Text": "\n    <p>\n    Although users may not be affected by certain vulnerabilities, all\n    kernels are affected by the CAN-2004-0394, CAN-2004-0427 and\n    CAN-2004-0554 issues which have no workaround. As a result, all users\n    are urged to upgrade their kernels to patched versions.\n    </p>\n  "
	},
	"Resolution": {
		"Text": "\n    \n    \n  ",
		"P": [
			{
				"Text": "\n    Users are encouraged to upgrade to the latest available sources for\n    their system:\n    ",
				"URI": {
					"Text": "",
					"Link": ""
				},
				"Br": null,
				"I": null,
				"Code": "",
				"P": ""
			}
		],
		"Code": [
			"\n    # emerge sync\n    # emerge -pv your-favorite-sources\n    # emerge your-favorite-sources\n    \n    # # Follow usual procedure for compiling and installing a kernel.\n    # # If you use genkernel, run genkernel as you would do normally."
		]
	},
	"References": {
		"URI": [
			{
				"Text": "CVE-2004-0109",
				"Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0109"
			},
			{
				"Text": "CVE-2004-0133",
				"Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0133"
			},
			{
				"Text": "CVE-2004-0177",
				"Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0177"
			},
			{
				"Text": "CVE-2004-0178",
				"Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0178"
			},
			{
				"Text": "CVE-2004-0181",
				"Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0181"
			},
			{
				"Text": "CVE-2004-0228",
				"Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0228"
			},
			{
				"Text": "CVE-2004-0229",
				"Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0229"
			},
			{
				"Text": "CVE-2004-0394",
				"Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0394"
			},
			{
				"Text": "CVE-2004-0427",
				"Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0427"
			},
			{
				"Text": "CVE-2004-0495",
				"Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0495"
			},
			{
				"Text": "CVE-2004-0535",
				"Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0535"
			},
			{
				"Text": "CVE-2004-0554",
				"Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0554"
			},
			{
				"Text": "CVE-2004-1983",
				"Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1983"
			}
		]
	},
	"Metadata": [
		{
			"Text": "\n    plasmaroo\n  ",
			"Tag": "submitter",
			"Timestamp": ""
		}
	]
}
