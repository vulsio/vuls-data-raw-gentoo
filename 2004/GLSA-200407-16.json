{
  "ID": "200407-16",
  "Title": "Linux Kernel: Multiple DoS and permission vulnerabilities",
  "Synopsis": "\n    Multiple permission vulnerabilities have been found in the Linux kernel,\n    allowing an attacker to change the group IDs of files mounted on a remote\n    filesystem (CAN-2004-0497), as well as an issue in 2.6 series kernels which\n    allows /proc permissions to be bypassed. A context sharing vulnerability in\n    vserver-sources is also handled by this advisory as well as CAN-2004-0447,\n    CAN-2004-0496 and CAN-2004-0565. Patched, or updated versions of these\n    kernels have been released and details are included along with this\n    advisory.\n  ",
  "Product": {
    "Text": "Kernel",
    "Type": "ebuild"
  },
  "Announced": "2004-07-22",
  "Revised": {
    "Text": "2011-03-27",
    "Count": "03"
  },
  "Bug": [
    "56171",
    "56479"
  ],
  "Access": "local",
  "Affected": {
    "Package": [
      {
        "Name": "sys-kernel/aa-sources",
        "Auto": "no",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.23-r2",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.6.5-r5",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.5-r5",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/alpha-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.21-r9",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.21-r9",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/ck-sources",
        "Auto": "no",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.26-r1",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.6.7-r5",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.7-r5",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/compaq-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.9.32.7-r8",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.9.32.7-r8",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/development-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.6.8_rc1",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.8_rc1",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/gentoo-dev-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.6.7-r8",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.7-r8",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/gentoo-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.19-r18",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.4.20-r21",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.4.22-r13",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.4.25-r6",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.4.26-r5",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.26-r5",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/grsec-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.26.2.0-r6",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.26.2.0-r6",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/gs-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.25_pre7-r8",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.25_pre7-r8",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/hardened-dev-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.6.7-r2",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.7-r2",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/hardened-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.26-r3",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.26-r3",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/hppa-dev-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.6.7_p1-r2",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.7_p1-r2",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/hppa-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.26_p6-r1",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.26_p6-r1",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/ia64-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.24-r7",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.24-r7",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/mm-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.6.7-r6",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.7-r6",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/openmosix-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.22-r11",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.22-r11",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/pac-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.23-r9",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.23-r9",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/planet-ccrma-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.21-r11",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.21-r11",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/pegasos-dev-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.6.7-r2",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.7-r2",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/pegasos-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.26-r3",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.26-r3",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/ppc-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.26-r3",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.26-r3",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/rsbac-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.26-r3",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.26-r3",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/rsbac-dev-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.6.7-r2",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.7-r2",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/selinux-sources",
        "Auto": "no",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.26-r2",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.26-r2",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/sparc-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.26-r3",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.26-r3",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/uclinux-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.26_p0-r3",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.6.7_p0-r2",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.7_p0-r2",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/usermode-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.24-r6",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.4.26-r3",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.6.6-r4",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.6-r4",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/vserver-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.0",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.26.1.28-r1",
            "Range": "lt",
            "Slot": ""
          },
          {
            "Text": "2.4",
            "Range": "ge",
            "Slot": ""
          },
          {
            "Text": "2.0",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/win4lin-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.26-r3",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.6.7-r2",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.7-r2",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/wolk-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "4.9-r10",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "4.11-r7",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "4.14-r4",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "4.14-r4",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/xbox-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.26-r3",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.6.7-r2",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.7-r2",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/mips-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.27",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.27",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/vanilla-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.27",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.26",
            "Range": "le",
            "Slot": ""
          }
        ]
      }
    ],
    "Service": {
      "Text": "",
      "Type": "",
      "Fixed": ""
    }
  },
  "Background": {
    "Text": "\n    <p>\n    The Linux kernel is responsible for managing the core aspects of a\n    GNU/Linux system, providing an interface for core system applications\n    as well as providing the essential structure and capability to access\n    hardware that is needed for a running system.\n    </p>\n  "
  },
  "Description": {
    "Text": "\n    <p>\n    The Linux kernel allows a local attacker to mount a remote file system\n    on a vulnerable Linux host and modify files' group IDs. On 2.4 series\n    kernels this vulnerability only affects shared NFS file systems. This\n    vulnerability has been assigned CAN-2004-0497 by the Common\n    Vulnerabilities and Exposures project.\n    </p>\n    <p>\n    Also, a flaw in the handling of /proc attributes has been found in 2.6\n    series kernels; allowing the unauthorized modification of /proc\n    entries, especially those which rely solely on file permissions for\n    security to vital kernel parameters.\n    </p>\n    <p>\n    An issue specific to the VServer Linux sources has been found, by which\n    /proc related changes in one virtual context are applied to other\n    contexts as well, including the host system.\n    </p>\n    <p>\n    CAN-2004-0447 resolves a local DoS vulnerability on IA64 platforms\n    which can cause unknown behaviour and CAN-2004-0565 resolves a floating\n    point information leak on IA64 platforms by which registers of other\n    processes can be read by a local user.\n    </p>\n    <p>\n    Finally, CAN-2004-0496 addresses some more unknown vulnerabilities in\n    2.6 series Linux kernels older than 2.6.7 which were found by the\n    Sparse source code checking tool.\n    </p>\n  "
  },
  "Impact": {
    "Type": "high",
    "Text": "\n    <p>\n    Bad Group IDs can possibly cause a Denial of Service on parts of a host\n    if the changed files normally require a special GID to properly\n    operate. By exploiting this vulnerability, users in the original file\n    group would also be blocked from accessing the changed files.\n    </p>\n    <p>\n    The /proc attribute vulnerability allows local users with previously no\n    permissions to certain /proc entries to exploit the vulnerability and\n    then gain read, write and execute access to entries.\n    </p>\n    <p>\n    These new privileges can be used to cause unknown behaviour ranging\n    from reduced system performance to a Denial of Service by manipulating\n    various kernel options which are usually reserved for the superuser.\n    This flaw might also be used for opening restrictions set through /proc\n    entries, allowing further attacks to take place through another\n    possibly unexpected attack vector.\n    </p>\n    <p>\n    The VServer issue can also be used to induce similar unexpected\n    behaviour to other VServer contexts, including the host. By successful\n    exploitation, a Denial of Service for other contexts can be caused\n    allowing only root to read certain /proc entries. Such a change would\n    also be replicated to other contexts, forbidding normal users on those\n    contexts to read /proc entries which could contain details needed by\n    daemons running as a non-root user, for example.\n    </p>\n    <p>\n    Additionally, this vulnerability allows an attacker to read information\n    from another context, possibly hosting a different server, gaining\n    critical information such as what processes are running. This may be\n    used for furthering the exploitation of either context.\n    </p>\n    <p>\n    CAN-2004-0447 and CAN-2004-0496 permit various local unknown Denial of\n    Service vulnerabilities with unknown impacts - these vulnerabilities\n    can be used to possibly elevate privileges or access reserved kernel\n    memory which can be used for further exploitation of the system.\n    </p>\n    <p>\n    CAN-2004-0565 allows FPU register values of other processes to be read\n    by a local user setting the MFH bit during a floating point operation -\n    since no check was in place to ensure that the FPH bit was owned by the\n    requesting process, but only an MFH bit check, an attacker can simply\n    set the MFH bit and access FPU registers of processes running as other\n    users, possibly those running as root.\n    </p>\n  "
  },
  "Workaround": {
    "Text": "\n    <p>\n    2.4 users may not be affected by CAN-2004-0497 if they do not use\n    remote network filesystems and do not have support for any such\n    filesystems in their kernel configuration. All 2.6 users are affected\n    by the /proc attribute issue and the only known workaround is to\n    disable /proc support. The VServer flaw applies only to\n    vserver-sources, and no workaround is currently known for the issue.\n    There is no known fix to CAN-2004-0447, CAN-2004-0496 or CAN-2004-0565\n    other than to upgrade the kernel to a patched version.\n    </p>\n    <p>\n    As a result, all users affected by any of these vulnerabilities should\n    upgrade their kernels to ensure the integrity of their systems.\n    </p>\n  "
  },
  "Resolution": {
    "Text": "\n    \n    \n  ",
    "P": [
      {
        "Text": "\n    Users are encouraged to upgrade to the latest available sources for\n    their system:\n    ",
        "URI": {
          "Text": "",
          "Link": ""
        },
        "Br": null,
        "I": null,
        "Code": "",
        "P": ""
      }
    ],
    "Code": [
      "\n    # emerge sync\n    # emerge -pv your-favorite-sources\n    # emerge your-favorite-sources\n    \n    # # Follow usual procedure for compiling and installing a kernel.\n    # # If you use genkernel, run genkernel as you would do normally."
    ]
  },
  "References": {
    "URI": [
      {
        "Text": "CAN-2004-0447",
        "Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0447"
      },
      {
        "Text": "CAN-2004-0496",
        "Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0496"
      },
      {
        "Text": "CAN-2004-0497",
        "Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0497"
      },
      {
        "Text": "CAN-2004-0565",
        "Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0565"
      },
      {
        "Text": "VServer /proc Context Vulnerability",
        "Link": "http://www.securityfocus.com/archive/1/367977"
      }
    ]
  },
  "Metadata": [
    {
      "Text": "\n    plasmaroo\n  ",
      "Tag": "submitter",
      "Timestamp": ""
    }
  ]
}
