{
  "ID": "200408-24",
  "Title": "Linux Kernel: Multiple information leaks",
  "Synopsis": "\n    Multiple information leaks have been found in the Linux kernel, allowing an\n    attacker to obtain sensitive data which may be used for further\n    exploitation of the system.\n  ",
  "Product": {
    "Text": "Kernel",
    "Type": "ebuild"
  },
  "Announced": "2004-08-25",
  "Revised": {
    "Text": "2011-03-27",
    "Count": "03"
  },
  "Bug": [
    "59378",
    "59769",
    "59905"
  ],
  "Access": "local",
  "Affected": {
    "Package": [
      {
        "Name": "sys-kernel/aa-sources",
        "Auto": "no",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.23-r2",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.6.5-r5",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.5-r5",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/alpha-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.21-r12",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.21-r12",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/ck-sources",
        "Auto": "no",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.26-r1",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.6.7-r5",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.7-r5",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/development-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.6.8",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.8",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/gentoo-dev-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.6.7-r12",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.7-r12",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/gentoo-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.19-r22",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.4.20-r25",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.4.22-r16",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.4.25-r9",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.4.26-r9",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.26-r9",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/grsec-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.27.2.0.1-r1",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.27.2.0.1-r1",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/gs-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.25_pre7-r11",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.25_pre7-r11",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/hardened-dev-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.6.7-r7",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.7-r7",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/hardened-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.27-r1",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.27-r1",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/hppa-dev-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.6.7_p14-r1",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.7_p14-r1",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/hppa-sources",
        "Auto": "no",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.26_p7-r1",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.26_p7-r1",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/ia64-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.24-r10",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.24-r10",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/mips-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.25-r8",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.4.26-r8",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.6.4-r8",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.6.6-r8",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.6.7-r5",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.6-r8",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/mm-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.6.8_rc4-r1",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.8_rc4-r1",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/openmosix-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.24-r4",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.24-r4",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/pac-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.23-r12",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.23-r12",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/pegasos-dev-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.6.8",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.8",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/rsbac-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.26-r5",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.26-r5",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/rsbac-dev-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.6.7-r5",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.7-r5",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/selinux-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.26-r3",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.26-r3",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/sparc-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.27-r1",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.27-r1",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/uclinux-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.26_p0-r6",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.6.7_p0-r5",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.7_p0-r5",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/usermode-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.24-r9",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.4.26-r6",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.6.6-r6",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.6-r6",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/vanilla-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.27",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.27",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/vserver-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.0",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.4.26.1.28-r4",
            "Range": "lt",
            "Slot": ""
          },
          {
            "Text": "2.0",
            "Range": "lt",
            "Slot": ""
          },
          {
            "Text": "2.4",
            "Range": "ge",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/win4lin-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.26-r6",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.6.7-r2",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.7-r5",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/wolk-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "4.9-r14",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "4.11-r10",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "4.14-r7",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "4.14-r7",
            "Range": "lt",
            "Slot": ""
          }
        ]
      },
      {
        "Name": "sys-kernel/xbox-sources",
        "Auto": "yes",
        "Arch": "*",
        "Unaffected": [
          {
            "Text": "2.4.27-r1",
            "Range": "rge",
            "Slot": ""
          },
          {
            "Text": "2.6.7-r5",
            "Range": "ge",
            "Slot": ""
          }
        ],
        "Vulnerable": [
          {
            "Text": "2.6.7-r5",
            "Range": "lt",
            "Slot": ""
          }
        ]
      }
    ],
    "Service": {
      "Text": "",
      "Type": "",
      "Fixed": ""
    }
  },
  "Background": {
    "Text": "\n    <p>\n    The Linux kernel is responsible for managing the core aspects of a\n    GNU/Linux system, providing an interface for core system applications\n    as well as providing the essential structure and capability to access\n    hardware that is needed for a running system.\n    </p>\n  "
  },
  "Description": {
    "Text": "\n    <p>\n    The Linux kernel allows a local attacker to obtain sensitive kernel\n    information by gaining access to kernel memory via several leaks in the\n    /proc interfaces. These vulnerabilities exist in various drivers which\n    make up a working Linux kernel, some of which are present across all\n    architectures and configurations.\n    </p>\n    <p>\n    CAN-2004-0415 deals with addressing invalid 32 to 64 bit conversions in\n    the kernel, as well as insecure direct access to file offset pointers\n    in kernel code which can be modified by the open(...), lseek(...) and\n    other core system I/O functions by an attacker.\n    </p>\n    <p>\n    CAN-2004-0685 deals with certain USB drivers using uninitialized\n    structures and then using the copy_to_user(...) kernel call to copy\n    these structures. This may leak uninitialized kernel memory, which can\n    contain sensitive information from user applications.\n    </p>\n    <p>\n    Finally, a race condition with the /proc/.../cmdline node was found,\n    allowing environment variables to be read while the process was still\n    spawning. If the race is won, environment variables of the process,\n    which might not be owned by the attacker, can be read.\n    </p>\n  "
  },
  "Impact": {
    "Type": "normal",
    "Text": "\n    <p>\n    These vulnerabilities allow a local unprivileged attacker to access\n    segments of kernel memory or environment variables which may contain\n    sensitive information. Kernel memory may contain passwords, data\n    transferred between processes and any memory which applications did not\n    clear upon exiting as well as the kernel cache and kernel buffers.\n    </p>\n    <p>\n    This information may be used to read sensitive data, open other attack\n    vectors for further exploitation or cause a Denial of Service if the\n    attacker can gain superuser access via the leaked information.\n    </p>\n  "
  },
  "Workaround": {
    "Text": "\n    <p>\n    There is no temporary workaround for any of these information leaks\n    other than totally disabling /proc support - otherwise, a kernel\n    upgrade is required. A list of unaffected kernels is provided along\n    with this announcement.\n    </p>\n  "
  },
  "Resolution": {
    "Text": "\n    \n    \n  ",
    "P": [
      {
        "Text": "\n    Users are encouraged to upgrade to the latest available sources for\n    their system:\n    ",
        "URI": {
          "Text": "",
          "Link": ""
        },
        "Br": null,
        "I": null,
        "Code": "",
        "P": ""
      }
    ],
    "Code": [
      "\n    # emerge sync\n    # emerge -pv your-favorite-sources\n    # emerge your-favorite-sources\n    \n    # # Follow usual procedure for compiling and installing a kernel.\n    # # If you use genkernel, run genkernel as you would normally."
    ]
  },
  "References": {
    "URI": [
      {
        "Text": "CAN-2004-0415",
        "Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0415"
      },
      {
        "Text": "CAN-2004-0685",
        "Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0685"
      },
      {
        "Text": "CVE-2004-1058",
        "Link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1058"
      }
    ]
  },
  "Metadata": [
    {
      "Text": "\n    plasmaroo\n  ",
      "Tag": "submitter",
      "Timestamp": "2004-08-17T02:16:55Z"
    }
  ]
}
